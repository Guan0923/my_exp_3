Args in experiment:
Namespace(random_seed=2026, is_training=1, model_id='384_96', model='PatchTSTwithSequence', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=384, k=3, lamda=0.1, label_len=48, pred_len=96, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=256, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 384_96_PatchTSTwithSequence_ETTh1_ftM_sl384_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8161
val 2785
test 2785
Epoch: 1 cost time: 2.6294052600860596
Epoch: 1, Steps: 31 | Train Loss: 0.8532759 Vali Loss: 1.4481792 Test Loss: 0.7689689
Validation loss decreased (inf --> 1.448179).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 2.1245884895324707
Epoch: 2, Steps: 31 | Train Loss: 0.7311526 Vali Loss: 0.9837972 Test Loss: 0.5152928
Validation loss decreased (1.448179 --> 0.983797).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 2.1605284214019775
Epoch: 3, Steps: 31 | Train Loss: 0.6147728 Vali Loss: 0.8549126 Test Loss: 0.4711694
Validation loss decreased (0.983797 --> 0.854913).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 2.113898992538452
Epoch: 4, Steps: 31 | Train Loss: 0.5652858 Vali Loss: 0.7746569 Test Loss: 0.4367300
Validation loss decreased (0.854913 --> 0.774657).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 2.193203926086426
Epoch: 5, Steps: 31 | Train Loss: 0.5360285 Vali Loss: 0.7348487 Test Loss: 0.4201425
Validation loss decreased (0.774657 --> 0.734849).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 2.0937139987945557
Epoch: 6, Steps: 31 | Train Loss: 0.5162614 Vali Loss: 0.7156081 Test Loss: 0.4114574
Validation loss decreased (0.734849 --> 0.715608).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 2.1877427101135254
Epoch: 7, Steps: 31 | Train Loss: 0.5028291 Vali Loss: 0.7146271 Test Loss: 0.4049122
Validation loss decreased (0.715608 --> 0.714627).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 2.2149345874786377
Epoch: 8, Steps: 31 | Train Loss: 0.4929251 Vali Loss: 0.6992770 Test Loss: 0.4000759
Validation loss decreased (0.714627 --> 0.699277).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.1216092109680176
Epoch: 9, Steps: 31 | Train Loss: 0.4857394 Vali Loss: 0.7009820 Test Loss: 0.3963583
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 2.125598907470703
Epoch: 10, Steps: 31 | Train Loss: 0.4809118 Vali Loss: 0.6932020 Test Loss: 0.3935563
Validation loss decreased (0.699277 --> 0.693202).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 2.130237340927124
Epoch: 11, Steps: 31 | Train Loss: 0.4757937 Vali Loss: 0.6887161 Test Loss: 0.3910379
Validation loss decreased (0.693202 --> 0.688716).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 2.1788573265075684
Epoch: 12, Steps: 31 | Train Loss: 0.4727803 Vali Loss: 0.6913400 Test Loss: 0.3889928
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.2894983291625977
Epoch: 13, Steps: 31 | Train Loss: 0.4696848 Vali Loss: 0.6846528 Test Loss: 0.3876044
Validation loss decreased (0.688716 --> 0.684653).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 2.119431972503662
Epoch: 14, Steps: 31 | Train Loss: 0.4666730 Vali Loss: 0.6884924 Test Loss: 0.3863892
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.369307041168213
Epoch: 15, Steps: 31 | Train Loss: 0.4638198 Vali Loss: 0.6858345 Test Loss: 0.3851708
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 2.0996036529541016
Epoch: 16, Steps: 31 | Train Loss: 0.4625217 Vali Loss: 0.6834840 Test Loss: 0.3841898
Validation loss decreased (0.684653 --> 0.683484).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 2.178151845932007
Epoch: 17, Steps: 31 | Train Loss: 0.4617514 Vali Loss: 0.6756288 Test Loss: 0.3831547
Validation loss decreased (0.683484 --> 0.675629).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 2.156737804412842
Epoch: 18, Steps: 31 | Train Loss: 0.4603411 Vali Loss: 0.6778550 Test Loss: 0.3826061
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 2.3779287338256836
Epoch: 19, Steps: 31 | Train Loss: 0.4587075 Vali Loss: 0.6801785 Test Loss: 0.3819651
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 2.1883554458618164
Epoch: 20, Steps: 31 | Train Loss: 0.4578141 Vali Loss: 0.6738024 Test Loss: 0.3813486
Validation loss decreased (0.675629 --> 0.673802).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 2.1941006183624268
Epoch: 21, Steps: 31 | Train Loss: 0.4574745 Vali Loss: 0.6865389 Test Loss: 0.3809215
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.1270811557769775
Epoch: 22, Steps: 31 | Train Loss: 0.4552545 Vali Loss: 0.6812335 Test Loss: 0.3804977
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.1321306228637695
Epoch: 23, Steps: 31 | Train Loss: 0.4557415 Vali Loss: 0.6740320 Test Loss: 0.3800674
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 2.117435932159424
Epoch: 24, Steps: 31 | Train Loss: 0.4545411 Vali Loss: 0.6732373 Test Loss: 0.3797526
Validation loss decreased (0.673802 --> 0.673237).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.2360856533050537
Epoch: 25, Steps: 31 | Train Loss: 0.4532064 Vali Loss: 0.6733776 Test Loss: 0.3794959
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 2.228689670562744
Epoch: 26, Steps: 31 | Train Loss: 0.4534464 Vali Loss: 0.6779616 Test Loss: 0.3791602
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 2.1433634757995605
Epoch: 27, Steps: 31 | Train Loss: 0.4535738 Vali Loss: 0.6722689 Test Loss: 0.3789245
Validation loss decreased (0.673237 --> 0.672269).  Saving model ...
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 2.1695444583892822
Epoch: 28, Steps: 31 | Train Loss: 0.4520388 Vali Loss: 0.6791846 Test Loss: 0.3787391
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 2.172819137573242
Epoch: 29, Steps: 31 | Train Loss: 0.4521288 Vali Loss: 0.6805720 Test Loss: 0.3785857
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 2.1426563262939453
Epoch: 30, Steps: 31 | Train Loss: 0.4519565 Vali Loss: 0.6761762 Test Loss: 0.3784124
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 2.157155752182007
Epoch: 31, Steps: 31 | Train Loss: 0.4514849 Vali Loss: 0.6798412 Test Loss: 0.3782490
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 2.1632423400878906
Epoch: 32, Steps: 31 | Train Loss: 0.4503470 Vali Loss: 0.6752857 Test Loss: 0.3780329
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 2.1129186153411865
Epoch: 33, Steps: 31 | Train Loss: 0.4502859 Vali Loss: 0.6768687 Test Loss: 0.3779577
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 2.150330066680908
Epoch: 34, Steps: 31 | Train Loss: 0.4504994 Vali Loss: 0.6744409 Test Loss: 0.3778442
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 2.196518898010254
Epoch: 35, Steps: 31 | Train Loss: 0.4501287 Vali Loss: 0.6742004 Test Loss: 0.3777598
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 2.148045778274536
Epoch: 36, Steps: 31 | Train Loss: 0.4503436 Vali Loss: 0.6773529 Test Loss: 0.3776492
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 2.1861770153045654
Epoch: 37, Steps: 31 | Train Loss: 0.4504350 Vali Loss: 0.6776348 Test Loss: 0.3775759
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 2.190727472305298
Epoch: 38, Steps: 31 | Train Loss: 0.4498579 Vali Loss: 0.6687222 Test Loss: 0.3774979
Validation loss decreased (0.672269 --> 0.668722).  Saving model ...
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 2.152276039123535
Epoch: 39, Steps: 31 | Train Loss: 0.4503731 Vali Loss: 0.6729968 Test Loss: 0.3774383
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 2.2036991119384766
Epoch: 40, Steps: 31 | Train Loss: 0.4499350 Vali Loss: 0.6701603 Test Loss: 0.3773808
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 2.1404788494110107
Epoch: 41, Steps: 31 | Train Loss: 0.4491149 Vali Loss: 0.6780697 Test Loss: 0.3773080
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 2.140620708465576
Epoch: 42, Steps: 31 | Train Loss: 0.4488816 Vali Loss: 0.6690001 Test Loss: 0.3772412
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 2.22033953666687
Epoch: 43, Steps: 31 | Train Loss: 0.4489933 Vali Loss: 0.6762844 Test Loss: 0.3772575
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 2.2257843017578125
Epoch: 44, Steps: 31 | Train Loss: 0.4492497 Vali Loss: 0.6680441 Test Loss: 0.3771326
Validation loss decreased (0.668722 --> 0.668044).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 2.1383261680603027
Epoch: 45, Steps: 31 | Train Loss: 0.4491242 Vali Loss: 0.6672487 Test Loss: 0.3771601
Validation loss decreased (0.668044 --> 0.667249).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 2.1705245971679688
Epoch: 46, Steps: 31 | Train Loss: 0.4496997 Vali Loss: 0.6736307 Test Loss: 0.3771334
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 2.2197046279907227
Epoch: 47, Steps: 31 | Train Loss: 0.4492477 Vali Loss: 0.6750087 Test Loss: 0.3770714
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 2.1827051639556885
Epoch: 48, Steps: 31 | Train Loss: 0.4494948 Vali Loss: 0.6734983 Test Loss: 0.3770738
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 2.187932014465332
Epoch: 49, Steps: 31 | Train Loss: 0.4481440 Vali Loss: 0.6682686 Test Loss: 0.3769950
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 2.144632577896118
Epoch: 50, Steps: 31 | Train Loss: 0.4494415 Vali Loss: 0.6764557 Test Loss: 0.3769631
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 2.1523334980010986
Epoch: 51, Steps: 31 | Train Loss: 0.4490615 Vali Loss: 0.6705726 Test Loss: 0.3769860
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 2.157811403274536
Epoch: 52, Steps: 31 | Train Loss: 0.4490921 Vali Loss: 0.6764184 Test Loss: 0.3770124
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 2.1774752140045166
Epoch: 53, Steps: 31 | Train Loss: 0.4485771 Vali Loss: 0.6766205 Test Loss: 0.3769622
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 2.1895816326141357
Epoch: 54, Steps: 31 | Train Loss: 0.4491693 Vali Loss: 0.6767705 Test Loss: 0.3769507
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 2.260728359222412
Epoch: 55, Steps: 31 | Train Loss: 0.4480848 Vali Loss: 0.6769344 Test Loss: 0.3769341
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 2.1777961254119873
Epoch: 56, Steps: 31 | Train Loss: 0.4485728 Vali Loss: 0.6743714 Test Loss: 0.3769279
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 2.1887264251708984
Epoch: 57, Steps: 31 | Train Loss: 0.4475708 Vali Loss: 0.6804916 Test Loss: 0.3768943
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 2.213371992111206
Epoch: 58, Steps: 31 | Train Loss: 0.4489651 Vali Loss: 0.6771078 Test Loss: 0.3768936
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 2.14200758934021
Epoch: 59, Steps: 31 | Train Loss: 0.4482068 Vali Loss: 0.6717010 Test Loss: 0.3768688
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 2.181581735610962
Epoch: 60, Steps: 31 | Train Loss: 0.4493740 Vali Loss: 0.6765317 Test Loss: 0.3768781
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 2.2700016498565674
Epoch: 61, Steps: 31 | Train Loss: 0.4492629 Vali Loss: 0.6776496 Test Loss: 0.3769012
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 2.1842851638793945
Epoch: 62, Steps: 31 | Train Loss: 0.4489405 Vali Loss: 0.6683155 Test Loss: 0.3768787
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 2.1635708808898926
Epoch: 63, Steps: 31 | Train Loss: 0.4480408 Vali Loss: 0.6732930 Test Loss: 0.3769225
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 2.1932532787323
Epoch: 64, Steps: 31 | Train Loss: 0.4491628 Vali Loss: 0.6790984 Test Loss: 0.3768629
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 2.2396328449249268
Epoch: 65, Steps: 31 | Train Loss: 0.4479465 Vali Loss: 0.6760396 Test Loss: 0.3768767
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 2.1832995414733887
Epoch: 66, Steps: 31 | Train Loss: 0.4486631 Vali Loss: 0.6760011 Test Loss: 0.3768743
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 2.215109348297119
Epoch: 67, Steps: 31 | Train Loss: 0.4491133 Vali Loss: 0.6704792 Test Loss: 0.3768243
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 2.173832893371582
Epoch: 68, Steps: 31 | Train Loss: 0.4488307 Vali Loss: 0.6746001 Test Loss: 0.3768565
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 2.1839544773101807
Epoch: 69, Steps: 31 | Train Loss: 0.4483596 Vali Loss: 0.6716555 Test Loss: 0.3768749
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.550049507968268e-08
